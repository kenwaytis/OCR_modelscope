image: ubuntu:latest

stages: 
  - build&push

build and push:
  stage: build&push
  script:
    - apt update
    - apt -y install git curl
    - curl -fsSL https://get.docker.com -o get-docker.sh
    - chmod +x get-docker.sh
    - ./get-docker.sh
    - git clone $CI_PROJECT_URL
    - cd $(echo $CI_PROJECT_NAME | cut -d'/' -f2)
    - docker pull hello-world:latest
    - docker tag hello-world:latest $PRIVATE_ADDRESS/$REPO_NAME:$CI_COMMIT_SHA
    - docker push $PRIVATE_ADDRESS/$REPO_NAME:$CI_COMMIT_SHA
    - echo "All jobs completed successfully."
